{% extends 'users/links.html' %}
{% block title %} Sign Up {% endblock%}

{%block body %}

<div class="container">
  <div class="red box" style="text-align: center;"> 
    <p>Register:</p>
  </div>
  <div class="row">
    <div class="col-md-1 col-xl-1 col-lg-1"></div>
    <div class="col-md-10 col-xl-10 col-lg-10">
      <form id="regForm" action="handlesignup" method="POST"  class="shadow-lg" style="border-radius: 30px;">
        {% csrf_token %}
        <div class="tab"><h1>Credential:</h1>
          <br>
            <label for="email"><b>Email</b></label>
            <input type="email" placeholder="Enter Email" name="email" required>
            <p id=email_hint></p>
          <br>
            <label for="password"><b>Password</b></label>
            <input id="mypassword" type="password" placeholder="Enter Password" name="password" required>
            <p id=pass_hintt></p>
          <br>
            <label for="repeat_password"><b>Repeat Password</b></label>
            <input type="password" placeholder="Repeat Password" name="repeat_password" required>
            <p id=pass_hint></p>
          <br>
        </div>
        <div class="tab"><h1>Profile Info:</h1>
          <div style="text-align: center;">
            <img  class="rounded-circle" width="30%" src="https://moonvillageassociation.org/wp-content/uploads/2018/06/default-profile-picture1.jpg">
          </div>
            <label for="profilePic">Choose photo:</label>
            <input type="file" id="avatar" name="profilePic" accept="image/png, image/jpeg" alt="https://moonvillageassociation.org/wp-content/uploads/2018/06/default-profile-picture1.jpg">
            <label for="name"><b>Enter Full Name</b></label>
            <input type="text" placeholder="Enter Name" name="name" required>
        </div>
        <div style="overflow:auto;">
          <div style="float:left;">
            <button style="width: 100%;background: none;border: none;" type="button" id="prevBtn" onclick="nextPrev(-1)"><p><i class="fa fa-chevron-left"></i></p></button>
          </div>
          <div style="float:right;">
            <button  style="width: 100%;background: none;border: none;" type="button" id="nextBtn" onclick="nextPrev(1)"><p><i class="fa fa-chevron-right"></i></p></button>
          </div>
          <div style="float: right;">
            <button id="mysubmit" style="display: none;background: none;border: none;" type="button" class="btn btn-block btn-outline-primary" data-toggle="modal" data-target="#exampleModalCenter"><p><i class="fa fa-check"></i></p></button>
          </div>
          <div style="text-align: center;"><p>Already a User?  <a  style="color: red;" href="mylogin">LOGIN</a></p></div>
        </div>
        <div style="text-align:center;margin-top:40px;">
          <span class="step"></span>
          <span class="step"></span>
        </div>
        <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalCenterTitle">Once saved cannot be changed</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                    Please Ensure that all data filled by you are correct as per your knowledge
                </div>
                <div class="modal-footer">
                  <div class="clearfix">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="submit" class="signupbtn btn btn-primary">Save changes</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div class="col-md-1 col-xl-1 col-lg-1"></div>
  </div>
</div>
<script type="text/javascript">
  var currentTab = 0;
  showTab(currentTab);
  function showTab(n) 
  {
    var x = document.getElementsByClassName("tab");
    x[n].style.display = "block";
    if(n == 0) 
    {
      document.getElementById("prevBtn").style.display = "none";
    } 
    else
    {
      document.getElementById("prevBtn").style.display = "inline";
    }
    if(n == (x.length - 1)) 
    {
      document.getElementById("nextBtn").style.display = "none";
      document.getElementById("mysubmit").style.display = "inline-block";
    } 
    else 
    {
      document.getElementById("nextBtn").style.display = "inline";
      document.getElementById("mysubmit").style.display = "none";
    }
    fixStepIndicator(n)
  }

  function nextPrev(n) 
  {
    var x = document.getElementsByClassName("tab");
    if(n==1 && !validateForm()){return false;}
    x[currentTab].style.display = "none";
    currentTab = currentTab + n;
    if (currentTab >= x.length) 
    {
      document.getElementById("regForm").submit();
      return false;
    }
    showTab(currentTab);
  }

  function validateForm() 
  {
    var x, y, i, valid = true;
    x = document.getElementsByClassName("tab");
    y = x[currentTab].getElementsByTagName("input");
    for (i = 0; i < y.length; i++) 
    {
      if (y[i].value == "") 
      {
        y[i].className += " invalid";
        valid = false;
      }
    }
    if(currentTab==0 && y[1].value != "")
    {
      if(y[1].className == "invalid")
        valid = false;
      if(y[1].value != y[2].value)
      {
        y[2].className += " invalid";
        valid = false;
      }
    }
    if(valid) 
    {
      document.getElementsByClassName("step")[currentTab].className += " finish";
    }
    return valid;
  }
  function fixStepIndicator(n) {
    var i, x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) {
      x[i].className = x[i].className.replace(" active", "");
    }
    x[n].className += " active";
  }
  $('input[name=repeat_password]').keyup(function () 
  {
      'use strict';
      if($('input[name=password]').val() === $(this).val()){
          $('#pass_hint').html('<i class="fa fa-check"></i> Matched');
          document.getElementById("pass_hint").style.color = "blue";
          this.setCustomValidity('');
      } 
      else{
          $('#pass_hint').html('<i class="fa fa-times"></i> Not matching');
          this.setCustomValidity('Passwords must match');
          document.getElementById("pass_hint").style.color = "red";
      }
  });
  $('input[name=email]').keyup(function () 
  {
      'use strict';
      var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      if(re.test($(this).val())) 
      {
          $('#email_hint').html('<i class="fa fa-check"></i> Valid');
          document.getElementById("email_hint").style.color = "blue";
          this.setCustomValidity('');
      } 
      else 
      {
          $('#email_hint').html('<i class="fa fa-times"></i> Not valid');
          document.getElementById("email_hint").style.color = "red";
          this.setCustomValidity('Should be valid email');
      }
  });
  $('input[name=password]').keyup(function () 
  {
    'use strict';
    var x, y, i, valid = true;
    x = document.getElementsByClassName("tab");
    y = x[currentTab].getElementsByTagName("input");
    var strongRegex = new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})");
    var mediumRegex = new RegExp("^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})");
    if (strongRegex.test($(this).val())) 
    {
      $('#pass_hintt').html('<i class="fa fa-check"></i> Strong Password');
      document.getElementById("pass_hintt").style.color = "blue";
      this.setCustomValidity('');
      y[0].className = "validated";
      valid = true;
    }
    else if(mediumRegex.test($(this).val()))
    {
      $('#pass_hintt').html('Medium Password');
      document.getElementById("pass_hintt").style.color = "yellow";
      this.setCustomValidity('');
      y[0].className = "invalid";
      valid = true;
    }
    else 
    {
      $('#pass_hintt').html('Password must contain one lower,one upper, one numeric and one special character');
      this.setCustomValidity('Passwords must be strong');
      document.getElementById("pass_hintt").style.color = "red";
      y[0].className = "invalid";
      valid = false;
    }
  });
</script>
<style>
  @media screen and (max-width: 680px)
  {
    .red p
    {
      margin-top: 5%;
      background-color: blanchedalmond;
      width: 100%;
      font-size: xx-large;
      border-radius: 30px;
    }
  }
  @media (min-width: 1200px) 
  { 
    .red p
    {
      margin-top: 10%;
      background-color: blanchedalmond;
      width: 40%;
      margin-left: 30%;
      font-size: xx-large;
      border-radius: 30px;
    }
  }
  #regForm 
  {
    padding: 40px;
  }
  .tab input 
  {
    padding: 10px;
    width: 100%;
    font-size: 17px;
    font-family: Raleway;
    border: none;
    outline: none;
    background: none;
    border-bottom: 2px solid black;
  }
  ::placeholder
  {
    text-align: center;
  }
  input.validated
  {
    border: none;
    outline: none;
  }
  input.invalid 
  {
    border: 1px solid red;
    border-radius: 10px;
  }
  .tab 
  {
    display: none;
  }
  .step 
  {
    height: 15px;
    width: 15px;
    margin: 0 2px;
    background-color: #bbbbbb;
    border: none;
    border-radius: 50%;
    display: inline-block;
    opacity: 0.5;
  }
  .step.active 
  {
    opacity: 1;
  }
  .step.finish 
  {
    background-color: #4CAF50;
  }
  body
  {
    background-image: repeating-linear-gradient(45deg,white,grey);
    background-size: cover;
    height: 100%;
  }
  html{
    height: 100%;
  }
</style>
{% endblock%}